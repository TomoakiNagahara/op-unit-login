<?php
/**	op-unit-login:/template/login/success.phtml
 *
 * @created    2025-06-04
 * @license    Apache-2.0
 * @package    op-unit-login
 * @copyright  (C) 2025 Tomoaki Nagahara
 */
?>
<h1>Login was successful.</h1>
<div>
	<span>This page will automatically reload in: </span><span id="countdown">10</span>
	<button name="cancel"> Cancel </button>
</div>
<script>
(function(){
	//	...
	let countdown = 10;
	let timerId;

	//	...
	function startReload() {
		//	...
		const display = document.getElementById('countdown');
		//	...
		timerId = setInterval(() => {
			//	...
			countdown--;
			display.textContent = countdown;
			//	...
			if (countdown <= 0) {
				location.href = '<?= OP()->Config('login')['login']['transfer'] ?? OP()->URL('app:/') ?>';
			}
		}, 1000);
	}

	//	...
	document.querySelector('button[name="cancel"]').addEventListener('click', function(){
		clearInterval(timerId);
		document.getElementById('countdown').textContent = 'Reload is canceled.';
	}, false);

	//	...
	startReload();
})();
</script>
